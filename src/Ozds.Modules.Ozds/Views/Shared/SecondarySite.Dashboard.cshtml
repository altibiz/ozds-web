@using Ozds.Modules.Ozds
@using Ozds.Elasticsearch
@using Ozds.Util

@inject IDashboardMeasurementProvider Provider

@model SecondarySiteType

@{
  var now = DateTime.UtcNow;
  var measurements = await Provider
    .GetDashboardMeasurementsAsync(
      Model.Site.Value.DeviceId,
      new Period
      {
        From = now.AddMinutes(-30),
        To = now
      })
    .Then(measurements => measurements.ToList());
}

<partial name="Dashboard" model="@measurements" />