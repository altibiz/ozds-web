var _templateObject,_templateObject2,_templateObject3;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _taggedTemplateLiteral(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function asyncGeneratorStep(e,r,t,n,a,o,i){try{var s=e[o](i),u=s.value}catch(e){return void t(e)}s.done?r(u):Promise.resolve(u).then(n,a)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var o=e.apply(r,t);function i(e){asyncGeneratorStep(o,n,a,i,s,"next",e)}function s(e){asyncGeneratorStep(o,n,a,i,s,"throw",e)}i(void 0)}))}}var getDashboardMeasurementsByDevice=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r,t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,query({query:gql(_templateObject||(_templateObject=_taggedTemplateLiteral(["\n      query ($deviceId: String!, $period: PeriodInput) {\n        dashboardMeasurementsByDevice(deviceId: $deviceId, period: $period) {\n          timestamp\n          deviceId\n          data {\n            energy\n            highCostEnergy\n            lowCostEnergy\n            power\n            powerL1\n            powerL2\n            powerL3\n            currentL1\n            currentL2\n            currentL3\n            voltageL1\n            voltageL2\n            voltageL3\n          }\n        }\n      }\n    "]))),variables:{deviceId:r,period:serializePeriod(t)}});case 2:if(n=e.sent){e.next=5;break}throw new Error("Failed fetching ");case 5:return e.abrupt("return",normalizeDashboardMeasurements(n.data.dashboardMeasurementsByDevice));case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),getDashboardMeasurementsByOwner=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r,t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,query({query:gql(_templateObject2||(_templateObject2=_taggedTemplateLiteral(["\n      query ($ownerId: String!, $period: PeriodInput) {\n        dashboardMeasurementsByOwner(ownerId: $ownerId, period: $period) {\n          timestamp\n          deviceId\n          data {\n            energy\n            highCostEnergy\n            lowCostEnergy\n            power\n            powerL1\n            powerL2\n            powerL3\n            currentL1\n            currentL2\n            currentL3\n            voltageL1\n            voltageL2\n            voltageL3\n          }\n        }\n      }\n    "]))),variables:{ownerId:r,period:serializePeriod(t)}});case 2:if(n=e.sent){e.next=5;break}throw new Error("Failed fetching");case 5:return e.abrupt("return",normalizeMultiDashboardMeasurements(n.data.dashboardMeasurementsByOwner));case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),getDashboardMeasurementsByOwnerUser=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r,t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,query({query:gql(_templateObject3||(_templateObject3=_taggedTemplateLiteral(["\n      query ($ownerUserId: String!, $period: PeriodInput) {\n        dashboardMeasurementsByOwnerUser(\n          ownerUserId: $ownerUserId\n          period: $period\n        ) {\n          timestamp\n          deviceId\n          data {\n            energy\n            highCostEnergy\n            lowCostEnergy\n            power\n            powerL1\n            powerL2\n            powerL3\n            currentL1\n            currentL2\n            currentL3\n            voltageL1\n            voltageL2\n            voltageL3\n          }\n        }\n      }\n    "]))),variables:{ownerUserId:r,period:serializePeriod(t)}});case 2:if(n=e.sent){e.next=5;break}throw new Error("Failed fetching");case 5:return e.abrupt("return",normalizeMultiDashboardMeasurements(n.data.dashboardMeasurementsByOwnerUser));case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),normalizeDashboardMeasurements=function(e){return e.map((function(e){return _objectSpread(_objectSpread({},e),{},{timestamp:deserializeDateTime(e.timestamp)})})).sort((function(e,r){return compareDateTime(e.timestamp,r.timestamp)}))},normalizeMultiDashboardMeasurements=function(e){return e=e.reduce((function(e,r){return e[(r=_objectSpread(_objectSpread({},r),{},{timestamp:deserializeDateTime(r.timestamp)})).deviceId]||(e[r.deviceId]=[]),e[r.deviceId].push(r),e}),{}),Object.values(e).forEach((function(e){return e.sort((function(e,r){return compareDateTime(e.timestamp,r.timestamp)}))})),e},deserializePeriod=function(e){return{from:deserializeDateTime(e.from),to:deserializeDateTime(e.to)}},serializePeriod=function(e){return{from:serializeDateTime(e.from),to:serializeDateTime(e.to)}},deserializeDateTime=function(e){return luxon.DateTime.fromISO(e,{zone:"utc"})},serializeDateTime=function(e){return e.toISO()},query=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://localhost:5001/graphql",{method:"POST",body:JSON.stringify(r),headers:{"content-type":"application/json"}});case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(r){return e.apply(this,arguments)}}(),compareDateTime=function(e,r){return e.toMillis()-r.toMillis()},gql=function(e){return e[0]};window.GraphQL={getDashboardMeasurementsByDevice:getDashboardMeasurementsByDevice,getDashboardMeasurementsByOwner:getDashboardMeasurementsByOwner,getDashboardMeasurementsByOwnerUser:getDashboardMeasurementsByOwnerUser,normalizeDashboardMeasurements:normalizeDashboardMeasurements,normalizeMultiDashboardMeasurements:normalizeMultiDashboardMeasurements,deserializePeriod:deserializePeriod,serializePeriod:serializePeriod,deserializeDateTime:deserializeDateTime,serializeDateTime:serializeDateTime};
